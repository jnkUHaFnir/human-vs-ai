    if (new_strlen(from) <= max)  //  should be < instead of <=