for (p = 0; i <= bl; p++) { // This should be p <= bl, not i <= bl
for (p = 0; p <= bl; p++) {
