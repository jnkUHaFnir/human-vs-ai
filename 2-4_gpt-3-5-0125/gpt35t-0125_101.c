
Note that this code snippet is written in NASM syntax for x86. You may need to adjust it for x64 or a different assembler.

Keep in mind that calling convention hijacking is generally considered a hack and may not be portable across different platforms or compiler versions. It's best to use it sparingly and only when absolutely necessary.
