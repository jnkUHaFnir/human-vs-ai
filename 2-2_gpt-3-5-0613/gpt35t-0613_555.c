
Keep in mind that this approach may not always work reliably and can potentially disrupt the user's workflow. It's generally best to inform the user about any open folders on the USB drive and request that they manually close them before ejecting the drive.
